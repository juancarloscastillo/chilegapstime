# NAs already identified
# Chunk 14
#--- Nombres sustantivos para analisis
salarios19 <- rename(salarios19,salperger=m2_p2_presidente,salperobr=m2_p2_obrero,
saljusger=m2_p3_presidente,saljusobr=m2_p3_obrero)
# Chunk 15: remover outliers 2019
salarios19 <- salarios19 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
summary(salarios19)
# Chunk 16: gap salario 2019
#---Brecha salarial percibida
salarios19$gap_perc   <-  as.numeric(salarios19$salperger/salarios19$salperobr) # diferencia total
salarios19$lngap_perc <-  as.numeric(log(salarios19$gap_perc))                  # diferencia log
#---Brecha salarial justa
salarios19$gap_just   <-  as.numeric(salarios19$saljusger/salarios19$saljusobr) # diferencia total
salarios19$lngap_just <-  as.numeric(log(salarios19$gap_just))                # diferencia log
# Chunk 17
load("../input/data/dataproc/dat99.RData")
load("../input/data/dataproc/dat09.RData")
load("../input/data/dataproc/dat19.RData")
# Chunk 18
table_perob<- rbind(psych::describe(dat99$salperobr),
psych::describe(dat09$salperobr),
psych::describe(dat19$salperobr))
rownames(table_perob) <- c("1999","2009","2019")
table_perob <- table_perob %>% select(n,mean,sd,median,trimmed,min,max)
table_perob
# Chunk 19
table_perger<- rbind(psych::describe(dat99$salperger),
psych::describe(dat09$salperger),
psych::describe(dat19$salperger))
rownames(table_perger) <- c("1999","2009","2019")
table_perger <- table_perger %>% select(n,mean,sd,median,trimmed,min,max)
table_perger
# Chunk 20
# Add occupation & year to tables
table_perob$ocup <-  1 # as.factor(c("Obrero"))
table_perob$year <- c(1999,2009,2019)
table_perger$ocup <- 2 # as.factor(c("Gerente"))
table_perger$year <- c(1999,2009,2019)
table_pertot <-rbind(table_perger,table_perob)
str(table_pertot)
table_pertot
#bar1
# Horizontal
table_pertot$ocup2 <- factor(table_pertot$ocup, levels=c(2,1), labels=c("Gerente", "Obrero"))
salario_per <-  ggplot(data=table_pertot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario percibido (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
salario_per
ggsave(salario_per,filename = "../output/images/salario_per.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Chunk 21
load(file="../input/data/dataproc/dataproccasen/salario_obrero.Rdata")
rownames(salario_obrero)<-c("1999","2009","2019")
salario_obrero <- salario_obrero %>% select(n,mean,sd,median,trimmed,min,max)
salario_obrero
# Chunk 22
load(file="../input/data/dataproc/dataproccasen/salario_gerente.Rdata")
rownames(salario_gerente)<-c("1999","2009","2019")
salario_gerente <- salario_gerente %>% select(n,mean,sd,median,trimmed,min,max)
salario_gerente
# Chunk 23
table_jusob<- rbind(psych::describe(dat99$saljusobr),
psych::describe(dat09$saljusobr),
psych::describe(dat19$saljusobr))
rownames(table_jusob) <- c("1999","2009","2019")
table_jusob <- table_jusob %>% select(n,mean,sd,median,trimmed,min,max)
table_jusob
# Chunk 24
table_jusger<- rbind(psych::describe(dat99$saljusger),
psych::describe(dat09$saljusger),
psych::describe(dat19$saljusger))
rownames(table_jusger) <- c("1999","2009","2019")
table_jusger <- table_jusger %>% select(n,mean,sd,median,trimmed,min,max)
table_jusger
# Chunk 25
# Add occupation & year to tables
table_jusob$ocup <-  1 # as.factor(c("Salario justo Obrero"))
table_jusob$year <- c(1999,2009,2019)
table_jusger$ocup <- 2 # as.factor(c("Salario justo Gerente"))
table_jusger$year <- c(1999,2009,2019)
salario_obrero$ocup <- 3 # as.factor(c("Salario real Obrero"))
salario_obrero$year <- c(1999,2009,2019)
salario_gerente$ocup <- 4 # as.factor(c("Salario real Obrero"))
salario_gerente$year <- c(1999,2009,2019)
table_justot <-rbind(table_jusger,table_jusob, salario_obrero,salario_gerente)
str(table_justot)
# Horizontal
table_justot$ocup2 <- factor(table_justot$ocup, levels=c(4,3,2,1), labels=c("salarioreal gerente", "Salario real Obrero", "Salario justo Gerente", "Salario justo Obrero"))
salario_justo <- ggplot(data=table_justot, aes(x=reorder(as.factor(year),-year), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario justo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
salario_justo
ggsave(salario_justo,filename = "../output/images/salario_justo.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Chunk 26
table_gap_perc<- rbind(psych::describe(dat99$gap_perc),
psych::describe(dat09$gap_perc),
psych::describe(dat19$gap_perc))
rownames(table_gap_perc) <- c("1999","2009","2019")
table_gap_perc <- table_gap_perc %>% select(n,mean,sd,median,trimmed,min,max)
table_gap_perc
# Chunk 27
table_gap_just<- rbind(psych::describe(dat99$gap_just),
psych::describe(dat09$gap_just),
psych::describe(dat19$gap_just))
rownames(table_gap_just) <- c("1999","2009","2019")
table_gap_just <- table_gap_just %>% select(n,mean,sd,median,trimmed,min,max)
table_gap_just
# Chunk 28
load(file = "../input/data/dataproc/dataproccasen/brecha.Rdata")
rownames(brecha_salarial) <- c("2000","2009","2017")
brecha_salarial <- brecha_salarial %>% select(n,mean,sd,median,trimmed,min,max)
brecha_salarial
# Chunk 29
# Add occupation & year to tables
table_gap_perc$ocup <-  1 # as.factor(c("Obrero"))
table_gap_perc$year <- c(1999,2009,2019)
table_gap_just$ocup <- 2 # as.factor(c("Gerente"))
table_gap_just$year <- c(1999,2009,2019)
brecha_salarial$ocup <- 3 # as.factor(c("Gerente"))
brecha_salarial$year <- c(1999,2009,2019)
table_gap_total <-rbind(table_gap_perc,table_gap_just,brecha_salarial)
str(table_gap_total)
table_gap_total
# Horizontal
table_gap_total$ocup2 <- factor(table_gap_total$ocup, levels=c(3,2,1), labels=c("Real(casen)", "Justa", "Percibida"))
brechas <- ggplot(data=table_gap_total, aes(x=reorder(as.factor(year),-year), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Brecha') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
ggsave(brechas,filename = "../output/images/Brechas.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
brechas
# Chunk 30
load(file = "../input/data/dataproc/cl09.RData")
load(file = "../input/data/dataproc/cl99.RData")
load(file = "../input/data/dataproc/cl19.RData")
load(file = "../input/data/dataproc/issp9919.RData")
library("dplyr")
library("corrplot")
library("ggplot2")
# Chunk 31
ed_gap<- clw3 %>% select("Educacion"=educ_rec, "Brecha_Percibida"=gap_perc, "Brecha_Justa"=gap_just,"year") %>% as.data.frame()
# Chunk 32
ed1_gap99 = ed_gap %>%  filter(Educacion == 1) %>% as.data.frame()
ed1_gap99 = ed1_gap99 %>% filter(year == 1999) %>% as.data.frame()
ed1_gap09 = ed_gap %>%  filter(Educacion == 1) %>% as.data.frame()
ed1_gap09 = ed1_gap09 %>% filter(year == 2009) %>% as.data.frame()
ed1_gap19 = ed_gap %>%  filter(Educacion == 1) %>% as.data.frame()
ed1_gap19 = ed1_gap19 %>% filter(year == 2019) %>% as.data.frame()
table_ed1<- rbind(psych::describe(ed1_gap99$Brecha_Percibida),
psych::describe(ed1_gap09$Brecha_Percibida),
psych::describe(ed1_gap19$Brecha_Percibida))
rownames(table_ed1) <- c("1999","2009","2019")
table_ed1 <- table_ed1 %>% select(n,mean,sd,median,trimmed,min,max)
table_ed1$Educacion<-1
table_ed1$years <- c(1999,2009,2019)
table_ed1
# Chunk 33
ed2_gap99 = ed_gap %>%  filter(Educacion == 2) %>% as.data.frame()
ed2_gap99 = ed2_gap99 %>% filter(year == 1999) %>% as.data.frame()
ed2_gap09 = ed_gap %>%  filter(Educacion == 2) %>% as.data.frame()
ed2_gap09 = ed2_gap09 %>% filter(year == 2009) %>% as.data.frame()
ed2_gap19 = ed_gap %>%  filter(Educacion == 2) %>% as.data.frame()
ed2_gap19 = ed2_gap19 %>% filter(year == 2019) %>% as.data.frame()
table_ed2<- rbind(psych::describe(ed2_gap99$Brecha_Percibida),
psych::describe(ed2_gap09$Brecha_Percibida),
psych::describe(ed2_gap19$Brecha_Percibida))
rownames(table_ed2) <- c("1999","2009","2019")
table_ed2 <- table_ed2 %>% select(n,mean,sd,median,trimmed,min,max)
table_ed2$Educacion<-2
table_ed2$years <- c(1999,2009,2019)
table_ed2
# Chunk 34
ed3_gap99 = ed_gap %>%  filter(Educacion == 3) %>% as.data.frame()
ed3_gap99 = ed3_gap99 %>% filter(year == 1999) %>% as.data.frame()
ed3_gap09 = ed_gap %>%  filter(Educacion == 3) %>% as.data.frame()
ed3_gap09 = ed3_gap09 %>% filter(year == 2009) %>% as.data.frame()
ed3_gap19 = ed_gap %>%  filter(Educacion == 3) %>% as.data.frame()
ed3_gap19 = ed3_gap19 %>% filter(year == 2019) %>% as.data.frame()
table_ed3<- rbind(psych::describe(ed3_gap99$Brecha_Percibida),
psych::describe(ed3_gap09$Brecha_Percibida),
psych::describe(ed3_gap19$Brecha_Percibida))
rownames(table_ed3) <- c("1999","2009","2019")
table_ed3 <- table_ed3 %>% select(n,mean,sd,median,trimmed,min,max)
table_ed3$Educacion<-3
table_ed3$years <- c(1999,2009,2019)
table_ed3
# Chunk 35
ed4_gap99 = ed_gap %>%  filter(Educacion == 4) %>% as.data.frame()
ed4_gap99 = ed4_gap99 %>% filter(year == 1999) %>% as.data.frame()
ed4_gap09 = ed_gap %>%  filter(Educacion == 4) %>% as.data.frame()
ed4_gap09 = ed4_gap09 %>% filter(year == 2009) %>% as.data.frame()
ed4_gap19 = ed_gap %>%  filter(Educacion == 4) %>% as.data.frame()
ed4_gap19 = ed4_gap19 %>% filter(year == 2019) %>% as.data.frame()
table_ed4<- rbind(psych::describe(ed4_gap99$Brecha_Percibida),
psych::describe(ed4_gap09$Brecha_Percibida),
psych::describe(ed4_gap19$Brecha_Percibida))
rownames(table_ed4) <- c("1999","2009","2019")
table_ed4 <- table_ed4 %>% select(n,mean,sd,median,trimmed,min,max)
table_ed4$Educacion<-4
table_ed4$years <- c(1999,2009,2019)
table_ed4
# Chunk 36
table_ed_gapper<-rbind(table_ed1,table_ed2,table_ed3,table_ed4)
table_ed_gapper$ocup2 <- factor(table_ed_gapper$Educacion, levels=c(1,2,3,4), labels=c("Basica o menos", "Media completa", "Tecnico completa" , "Universitario o más"))
# Horizontal
table_ed_gapper <-  ggplot(data=table_ed_gapper, aes(x=reorder(as.factor(years),-years), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Brecha percibida segun nivel educativo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
table_ed_gapper
ggsave(table_ed_gapper,filename = "../output/images/gapper_educ.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Chunk 37
table_ed1_jus<- rbind(psych::describe(ed1_gap99$Brecha_Justa),
psych::describe(ed1_gap09$Brecha_Justa),
psych::describe(ed1_gap19$Brecha_Justa))
rownames(table_ed1_jus) <- c("1999","2009","2019")
table_ed1_jus <- table_ed1_jus %>% select(n,mean,sd,median,trimmed,min,max)
table_ed1_jus$Educacion<-1
table_ed1_jus$years <- c(1999,2009,2019)
table_ed1_jus
# Chunk 38
table_ed2_jus<- rbind(psych::describe(ed2_gap99$Brecha_Justa),
psych::describe(ed2_gap09$Brecha_Justa),
psych::describe(ed2_gap19$Brecha_Justa))
rownames(table_ed2_jus) <- c("1999","2009","2019")
table_ed2_jus <- table_ed2_jus %>% select(n,mean,sd,median,trimmed,min,max)
table_ed2_jus$Educacion<-2
table_ed2_jus$years <- c(1999,2009,2019)
table_ed2_jus
# Chunk 39
table_ed3_jus<- rbind(psych::describe(ed3_gap99$Brecha_Justa),
psych::describe(ed3_gap09$Brecha_Justa),
psych::describe(ed3_gap19$Brecha_Justa))
rownames(table_ed3_jus) <- c("1999","2009","2019")
table_ed3_jus <- table_ed3_jus %>% select(n,mean,sd,median,trimmed,min,max)
table_ed3_jus$Educacion<-3
table_ed3_jus$years <- c(1999,2009,2019)
table_ed3_jus
# Chunk 40
table_ed4_jus<- rbind(psych::describe(ed4_gap99$Brecha_Justa),
psych::describe(ed4_gap09$Brecha_Justa),
psych::describe(ed4_gap19$Brecha_Justa))
rownames(table_ed4_jus) <- c("1999","2009","2019")
table_ed4_jus <- table_ed4_jus %>% select(n,mean,sd,median,trimmed,min,max)
table_ed4_jus$Educacion<-4
table_ed4_jus$years <- c(1999,2009,2019)
table_ed4_jus
# Chunk 41
table_ed_gapjus<-rbind(table_ed1_jus,table_ed2_jus,table_ed3_jus,table_ed4_jus)
table_ed_gapjus$ocup2 <- factor(table_ed_gapjus$Educacion, levels=c(1,2,3,4), labels=c("Basica o menos", "Media completa", "Tecnico completa" , "Universitario o más"))
# Horizontal
table_ed_gapjus <-  ggplot(data=table_ed_gapjus, aes(x=reorder(as.factor(years),-years), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Brecha justa segun nivel educativo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
table_ed_gapjus
ggsave(table_ed_gapjus,filename = "../output/images/gapjus_educ.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Chunk 42
load(file = "../input/data/dataproc/dat99.RData")
load(file = "../input/data/dataproc/dat09.RData")
load(file = "../input/data/dataproc/dat19.RData")
# Chunk 43
ed_redis<- clw3 %>% select("Educacion"=educ_rec, "Redistribution"=redis, year) %>% as.data.frame()
ed_redis <-na.omit(ed_redis)
ed1_redis99 = ed_redis %>%  filter(Educacion == 1) %>% as.data.frame()
ed1_redis99 = ed1_redis99 %>% filter(year == 1999) %>% as.data.frame()
ed1_redis09 = ed_redis %>%  filter(Educacion == 1) %>% as.data.frame()
ed1_redis09 = ed1_redis09 %>% filter(year == 2009) %>% as.data.frame()
ed1_redis19 = ed_redis %>%  filter(Educacion == 1) %>% as.data.frame()
ed1_redis19 = ed1_redis19 %>% filter(year == 2019) %>% as.data.frame()
table_redis_ed1<- rbind(psych::describe(ed1_redis99$Redistriution),
psych::describe(ed1_redis09$Redistriution),
psych::describe(ed1_redis19$Redistriution))
rownames(table_redis_ed1) <- c("1999","2009","2019")
table_redis_ed1 <- table_redis_ed1 %>% select(n,mean,sd,median,trimmed,min,max)
table_redis_ed1$Educacion<-1
table_redis_ed1$years <- c(1999,2009,2019)
table_redis_ed1
# Chunk 44
ed2_redis99 = ed_redis %>%  filter(Educacion == 2) %>% as.data.frame()
ed2_redis99 = ed2_redis99 %>% filter(year == 1999) %>% as.data.frame()
ed2_redis09 = ed_redis %>%  filter(Educacion == 2) %>% as.data.frame()
ed2_redis09 = ed2_redis09 %>% filter(year == 2009) %>% as.data.frame()
ed2_redis19 = ed_redis %>%  filter(Educacion == 2) %>% as.data.frame()
ed2_redis19 = ed2_redis19 %>% filter(year == 2019) %>% as.data.frame()
table_redis_ed2<- rbind(psych::describe(ed2_redis99$Redistriution),
psych::describe(ed2_redis09$Redistriution),
psych::describe(ed2_redis19$Redistriution))
rownames(table_redis_ed2) <- c("1999","2009","2019")
table_redis_ed2 <- table_redis_ed2 %>% select(n,mean,sd,median,trimmed,min,max)
table_redis_ed2$Educacion<-2
table_redis_ed2$years <- c(1999,2009,2019)
table_redis_ed2
# Chunk 45
ed3_redis99 = ed_redis %>%  filter(Educacion == 3) %>% as.data.frame()
ed3_redis99 = ed3_redis99 %>% filter(year == 1999) %>% as.data.frame()
ed3_redis09 = ed_redis %>%  filter(Educacion == 3) %>% as.data.frame()
ed3_redis09 = ed3_redis09 %>% filter(year == 2009) %>% as.data.frame()
ed3_redis19 = ed_redis %>%  filter(Educacion == 3) %>% as.data.frame()
ed3_redis19 = ed3_redis19 %>% filter(year == 2019) %>% as.data.frame()
table_redis_ed3<- rbind(psych::describe(ed3_redis99$Redistriution),
psych::describe(ed3_redis09$Redistriution),
psych::describe(ed3_redis19$Redistriution))
rownames(table_redis_ed3) <- c("1999","2009","2019")
table_redis_ed3 <- table_redis_ed3 %>% select(n,mean,sd,median,trimmed,min,max)
table_redis_ed3$Educacion<-3
table_redis_ed3$years <- c(1999,2009,2019)
table_redis_ed3
# Chunk 46
ed4_redis99 = ed_redis %>%  filter(Educacion == 4) %>% as.data.frame()
ed4_redis99 = ed4_redis99 %>% filter(year == 1999) %>% as.data.frame()
ed4_redis09 = ed_redis %>%  filter(Educacion == 4) %>% as.data.frame()
ed4_redis09 = ed4_redis09 %>% filter(year == 2009) %>% as.data.frame()
ed4_redis19 = ed_redis %>%  filter(Educacion == 4) %>% as.data.frame()
ed4_redis19 = ed4_redis19 %>% filter(year == 2019) %>% as.data.frame()
table_redis_ed4<- rbind(psych::describe(ed4_redis99$Redistriution),
psych::describe(ed4_redis09$Redistriution),
psych::describe(ed4_redis19$Redistriution))
rownames(table_redis_ed4) <- c("1999","2009","2019")
table_redis_ed4 <- table_redis_ed4 %>% select(n,mean,sd,median,trimmed,min,max)
table_redis_ed4$Educacion<-4
table_redis_ed4$years <- c(1999,2009,2019)
table_redis_ed4
# Chunk 47
ed_redis99 = ed_redis %>% filter(year == 1999) %>% as.data.frame()
ed_redis09 = ed_redis %>% filter(year == 2009) %>% as.data.frame()
ed_redis19 = ed_redis %>% filter(year == 2019) %>% as.data.frame()
table_redis_ed<- rbind(psych::describe(ed_redis99$Redistriution),
psych::describe(ed_redis09$Redistriution),
psych::describe(ed_redis19$Redistriution))
rownames(table_redis_ed) <- c("1999","2009","2019")
table_redis_ed <- table_redis_ed %>% select(n,mean,sd,median,trimmed,min,max)
table_redis_ed$Educacion<-5
table_redis_ed$years <- c(1999,2009,2019)
table_redis_ed
# Chunk 48
table_ed_redistribution<-rbind(table_redis_ed1,table_redis_ed2,table_redis_ed3,table_redis_ed4)
table_ed_redistribution$ocup2 <- factor(table_ed_redistribution$Educacion, levels=c(1,2,3,4), labels=c("Basica o menos", "Media completa", "Tecnico completa" , "Universitario o más"))
# Horizontal
table_ed_redistribution <-  ggplot(data=table_ed_redistribution, aes(x=reorder(as.factor(years),-years), y=mean, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(mean, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Redistribution segun nivel educativo (promedio)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
table_ed_redistribution
ggsave(table_ed_redistribution,filename = "../output/images/rediseduc.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Chunk 49
#1999
reg1a<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat99)
reg2a<-glm(redis ~ lngap_perc + lngap_just + permer, family = binomial, data=dat99)
reg3a<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media +  tecnico  , family = binomial, data=dat99)
reg4a<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media + tecnico   + bajo + mediobajo + medio + medioalto + alto, family = binomial, data=dat99)
#2009
reg1b<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat09)
reg2b<-glm(redis ~ lngap_perc + lngap_just + permer, family = binomial, data=dat09)
reg3b<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media +  tecnico  , family = binomial, data=dat09)
reg4b<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media + tecnico   + bajo + mediobajo + medio + medioalto + alto, family = binomial, data=dat09)
#2019
reg1c<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat19)
reg2c<-glm(redis ~ lngap_perc + lngap_just + permer, family = binomial, data=dat19)
reg3c<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media +  tecnico  , family = binomial, data=dat19)
reg4c<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media + tecnico   + bajo + mediobajo + medio + medioalto + alto, family = binomial, data=dat19)
library(stargazer)
stargazer(list(reg1a,reg2a,reg3a,reg4a,reg1b,reg2b,reg3b,reg4b,reg1c,reg2c,reg3c,reg4c), type="text")
# Chunk 50
#1999
reg1a<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat99)
reg2a<-glm(redis ~ lngap_perc + lngap_just + permer, family = binomial, data=dat99)
reg3a<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media +  tecnico  , family = binomial, data=dat99)
reg4a<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media + tecnico   + bajo + mediobajo + medio + medioalto + alto, family = binomial, data=dat99)
#2009
reg1b<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat09)
reg2b<-glm(redis ~ lngap_perc + lngap_just + permer, family = binomial, data=dat09)
reg3b<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media +  tecnico  , family = binomial, data=dat09)
reg4b<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media + tecnico   + bajo + mediobajo + medio + medioalto + alto, family = binomial, data=dat09)
#2019
reg1c<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat19)
reg2c<-glm(redis ~ lngap_perc + lngap_just + permer, family = binomial, data=dat19)
reg3c<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media +  tecnico  , family = binomial, data=dat19)
reg4c<-glm(redis ~ lngap_perc + lngap_just + permer + basica + media + tecnico   + bajo + mediobajo + medio + medioalto + alto, family = binomial, data=dat19)
library(stargazer)
stargazer(list(reg1a,reg2a,reg3a,reg4a,reg1b,reg2b,reg3b,reg4b,reg1c,reg2c,reg3c,reg4c), type="html")
# Chunk 51
load("../input/data/dataproc/issp9919.RData")
# Chunk 52
#install.packages("stargazer")
library(stargazer)
library(dplyr)
library(sjPlot)
# Chunk 53
reg_year<- lm(lngap_just~lngap_perc*year, data=clw3 )
stargazer(reg_year, type="text")
# Chunk 54
int<-plot_model(reg_year, type="int")
int
# Chunk 55: pregunta redistribucion
load("../input/data/dataproc/dat99.RData")
load("../input/data/dataproc/dat09.RData")
load("../input/data/dataproc/dat19.RData")
load("../input/data/dataproc/dataproccasen/brecha.Rdata")
# Chunk 56
dat99gap <- dat99 %>% dplyr::select("gap_perc","lngap_perc","gap_just","lngap_just", "redis")
dat99gap<-na.omit(dat99gap)
dat99gap$desajuste<-as.numeric(median(brecha_salarial[,2]) - dat99gap$gap_perc)
dat99gap$subrepresenta<-ifelse(dat99gap$desajuste>=1,1,0)
summary(dat99gap$desajuste)
hist(dat99gap$desajuste)
hist(dat99gap$subrepresenta)
# Chunk 57
dat09gap <- dat09 %>% dplyr::select("gap_perc","lngap_perc","gap_just","lngap_just", "redis")
dat09gap<-na.omit(dat09gap)
dat09gap$desajuste<-as.numeric(median(brecha_salarial[,2]) - dat09gap$gap_perc)
dat09gap$subrepresenta<-ifelse(dat09gap$desajuste>=1,1,0)
summary(dat09gap$desajuste)
hist(dat09gap$desajuste)
hist(dat09gap$subrepresenta)
# Chunk 58
dat19gap <- dat19 %>% dplyr::select("gap_perc","lngap_perc","gap_just","lngap_just", "redis")
dat19gap<-na.omit(dat19gap)
dat19gap$desajuste<-as.numeric(median(brecha_salarial[,3]) - dat19gap$gap_perc)
dat19gap$subrepresenta<-ifelse(dat19gap$desajuste>=1,1,0)
median(dat19gap$desajuste)
hist(dat19gap$desajuste)
hist(dat19gap$subrepresenta)
# Chunk 59
regdes99<-glm(redis ~  desajuste , family = binomial, data=dat99gap)
regdes09<-glm(redis ~  desajuste , family = binomial, data=dat09gap)
regdes191<-glm(redis ~  subrepresenta , family = binomial, data=dat19gap)
regdes192<-glm(redis ~  desajuste , family = binomial, data=dat19gap)
regdes193<-glm(redis ~  subrepresenta + desajuste , family = binomial, data=dat19gap)
stargazer(list(regdes99,regdes09,regdes192,regdes191,regdes193), type="text")
# Chunk 60
load("../input/data/origin data/datacep/dat09.RData")
load("../input/data/origin data/datacep/dat19.RData")
# Chunk 61
#2009
reg1b<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat09)
reg2b<-glm(redis ~ lngap_perc + lngap_just + permerit, family = binomial, data=dat09)
reg3b<-glm(redis ~ lngap_perc + lngap_just + permerit + c.izquerda + centro + c.derecha +  derecha + independiente + ninguna , family = binomial, data=dat09)
#2019
reg1c<-glm(redis ~ lngap_perc + lngap_just, family = binomial, data=dat19)
reg2c<-glm(redis ~ lngap_perc + lngap_just + permerit, family = binomial, data=dat19)
reg3c<-glm(redis ~ lngap_perc + lngap_just + permerit + c.izquerda + centro + c.derecha +  derecha + independiente + ninguna, family = binomial, data=dat19)
stargazer(list(reg1b,reg2b,reg3b,reg1c,reg2c,reg3c), type="text")
# Chunk 62
load("../input/data/dataproc/dat99.RData")
#sjPlot::view_df(dat99)
r99a<-lm(gap_perc ~ permer ,data=dat99)
r99b<-lm(gap_perc ~ permer  + media + tecnico + universitaria + mediobajo + medio + medioalto + alto + muyalto , data=dat99)
r99c<-lm(gap_just ~ gap_perc ,data=dat99)
r99d<-lm(gap_just ~ gap_perc + permer ,data=dat99)
r99e<-lm(gap_just ~ gap_perc + permer  + media + tecnico + universitaria + mediobajo + medio + medioalto + alto + muyalto , data=dat99)
stargazer(list(r99a,r99b,r99c,r99d,r99e), type= "text")
# Chunk 63
load(file="../input/data/dataproc/dat09.RData")
#sjPlot::view_df(dat09)
r09a<-lm(gap_perc ~ permer ,data=dat09)
r09b<-lm(gap_perc ~ permer  + media + tecnico + universitaria + mediobajo + medio + medioalto + alto + muyalto , data=dat09)
r09c<-lm(gap_just ~ gap_perc ,data=dat09)
r09d<-lm(gap_just ~ gap_perc + permer ,data=dat09)
r09e<-lm(gap_just ~ gap_perc + permer  + media + tecnico + universitaria + mediobajo + medio + medioalto + alto + muyalto , data=dat09)
stargazer(list(r09a,r09b,r09c,r09d,r09e), type= "text")
# Chunk 64
load(file="../input/data/dataproc/dat19.RData")
#sjPlot::view_df(dat19)
r19a<-lm(gap_perc ~ permer ,data=dat19)
r19b<-lm(gap_perc ~ permer  + media + tecnico + universitaria + mediobajo + medio + medioalto + alto + muyalto , data=dat19)
r19c<-lm(gap_just ~ gap_perc ,data=dat19)
r19d<-lm(gap_just ~ gap_perc + permer ,data=dat19)
r19e<-lm(gap_just ~ gap_perc + permer  + media + tecnico + universitaria + mediobajo + medio + medioalto + alto + muyalto , data=dat19)
stargazer(list(r19a,r19b,r19c,r19d,r19e), type= "text")
